#!/usr/bin/env ruby
# frozen_string_literal: true

require 'bundler/setup'
require 'nasfaa'

command = ARGV[0]

case command
when 'walkthrough'
  require 'io/console'
  puts "NASFAA Data Sharing Decision Tree — Interactive Walkthrough"
  puts "v#{Nasfaa::VERSION}"
  puts
  puts "Answer each question with 'yes' or 'no' to navigate the decision tree."
  puts "The walkthrough follows the NASFAA PDF's two-page flowchart."

  walkthrough = Nasfaa::Walkthrough.new
  walkthrough.run
when 'quiz'
  require 'io/console'
  random = ARGV.include?('--random')
  puts "NASFAA Data Sharing Decision Tree — Quiz Mode#{random ? ' (Random)' : ''}"
  puts "v#{Nasfaa::VERSION}"
  puts
  puts "Answer 'permit' or 'deny' for each disclosure scenario."

  quiz = Nasfaa::Quiz.new(random: random)
  quiz.run
when 'evaluate'
  compact = ARGV[1]
  unless compact
    puts 'Usage: nasfaa evaluate <string>'
    puts
    puts 'Compact string of y/n answers followed by optional p/d assertion.'
    puts 'Example: nasfaa evaluate ynnyp'
    exit 1
  end
  evaluator = Nasfaa::Evaluate.new(compact)
  evaluator.run
else
  puts "nasfaa v#{Nasfaa::VERSION}"
  puts
  puts 'Usage: nasfaa <command>'
  puts
  puts 'Commands:'
  puts '  walkthrough        Step through the decision tree interactively'
  puts '  quiz               Test your knowledge with scenario-based questions'
  puts '  evaluate <string>  Evaluate a path through the decision tree'
end
